@echo off
title IPGW_Core 轻松使用
cd /d "%~dp0"
ipgw_core -e "WshShell=WIN32OLE.new('WScript.Shell');strDesktop=WshShell.SpecialFolders('Desktop');oShellLink=WshShell.CreateShortcut(File.join(strDesktop,'Interactive IPGW.lnk'));oShellLink.TargetPath=File.join($appDir,'ipgw_core.exe');oShellLink.Arguments='examples\i_ipgw.rb';oShellLink.IconLocation=File.join($appDir,'ipgw_core.exe, 0');oShellLink.WorkingDirectory=$appDir;oShellLink.Description='以交互模式执行连接网关的 Ruby 脚本';oShellLink.Save;oShellLink=WshShell.CreateShortcut(File.join(strDesktop,'IPGW Hotkeys.lnk'));oShellLink.TargetPath=File.join($appDir,'ipgw_core.exe');oShellLink.Arguments='examples\hotkeys.rb';oShellLink.IconLocation=File.join($appDir,'ipgw_core.exe, 4');oShellLink.WorkingDirectory=$appDir;oShellLink.Description='为网关操作提供全局热键支持';oShellLink.Save;puts;puts ' Two desktop shortcut files have been created.';puts;puts ' Would you like to run IPGW Hotkeys automatically';print ' at startup for convenience purposes [Y/N]? ';if `choice /N`.chomp=='Y' then WshShell.RegWrite('HKCU\Software\Microsoft\Windows\CurrentVersion\Run\IPGWhotkeys','\"'+$appDir.sub(/\\?$/,'\ipgw_core.exe\"')+' \"'+$appDir.sub(/\\?$/,'\examples\hotkeys.rb\"'));print \"\n \";system('pause') end"
